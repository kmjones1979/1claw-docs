# 1Claw — AI Agent Secrets Management

> HSM-backed secret management for AI agents and humans. Zero-knowledge vault with envelope encryption, agent-native access control, customer-managed encryption keys (CMEK), Intents API for transaction signing, and x402 micropayments.

## Links

- Website: https://1claw.xyz
- API: https://api.1claw.xyz
- Docs: https://docs.1claw.xyz
- MCP Server: https://mcp.1claw.xyz
- Dashboard: https://1claw.xyz (login required)
- GitHub: https://github.com/1clawAI/1claw
- npm SDK: https://www.npmjs.com/package/@1claw/sdk
- npm CLI: https://www.npmjs.com/package/@1claw/cli
- npm MCP: https://www.npmjs.com/package/@1claw/mcp
- npm OpenAPI Spec: https://www.npmjs.com/package/@1claw/openapi-spec
- Contact: ops@1claw.xyz

## What 1Claw Does

1Claw stores and manages secrets (API keys, tokens, certificates, private keys, environment variables) in HSM-backed encrypted vaults. AI agents are first-class principals — they authenticate with scoped API keys, receive short-lived JWTs, and access only the secret paths explicitly granted by a human via policies.

## Architecture

- **Vault API** (Rust/Axum) at api.1claw.xyz — RESTful API with JWT Bearer auth
- **Dashboard** (Next.js) at 1claw.xyz — Web UI for humans
- **MCP Server** (TypeScript) at mcp.1claw.xyz — Model Context Protocol for AI agents
- **SDK** (@1claw/sdk) — TypeScript client library
- **CLI** (@1claw/cli) — Command-line tool for CI/CD and DevOps

## Authentication

- **Human users**: Email/password, Google OAuth, or personal API keys (`1ck_` prefix)
- **AI agents**: Three auth methods — API key (`ocv_` prefix, default), mTLS (client certificate), or OIDC Client Credentials. API key agents exchange credentials for short-lived JWT via `POST /v1/auth/agent-token`.
- **MFA**: Optional TOTP 2FA for human logins (Pro tier and above)
- **API keys**: `1ck_` keys work as Bearer tokens on all authenticated endpoints

## Core Concepts

### Vaults
Isolated containers for secrets. Each vault has its own HSM key encryption key (KEK). Secrets within a vault are envelope-encrypted: per-secret data encryption keys (DEKs) wrapped by the vault KEK.

### Secrets
Key-value pairs stored in vaults, addressed by path (e.g., `api-keys/stripe`). Supports types: generic, password, api_key, certificate, private_key, ssh_key, env. Secrets are versioned. Optional metadata, expiry, and max access count.

### Agents
AI agent identities registered via the dashboard or API. Agents support three authentication methods: `api_key` (default, generates `ocv_` prefixed key), `mtls` (client certificate fingerprint), and `oidc_client_credentials` (OIDC issuer + client ID). All agents automatically receive an Ed25519 SSH keypair stored in a dedicated `__agent-keys` vault for future encrypted A2A messaging. Agents can be scoped to specific vaults (`vault_ids`), specific secret paths (via policies), and have a custom token TTL (`token_ttl_seconds`). Agents cannot access anything not explicitly granted by a human.

### Policies
Access control rules that bind a principal (agent or user) to a set of secret paths in a vault. Policies specify path patterns (glob), permissions (read/write), optional conditions (IP ranges, time windows), and expiry.

### Customer-Managed Encryption Keys (CMEK)
Enterprise opt-in feature. The human generates a 256-bit AES key in the dashboard (WebCrypto). The key never leaves their device — only its SHA-256 fingerprint is stored on the server. Secrets are encrypted client-side before upload. Server-assisted rotation re-encrypts all secrets in batches of 100 with progress tracking.

### Intents API
Agents can sign and broadcast EVM transactions without seeing private keys. Keys stay in the HSM. Per-agent guardrails: allowed chains, recipient allowlists, per-tx value caps, daily spending limits. Supports EIP-155 legacy and EIP-1559 Type 2 transactions. Optional Tenderly simulation before signing. Replay protection via `Idempotency-Key` header (UUID, 24h TTL; auto-generated by SDK and MCP). Server-side nonce serialization with an atomic `nonce_tracker` table (`SELECT FOR UPDATE`) prevents nonce collisions across concurrent agents. `GET .../transactions/{tx_id}` redacts `signed_tx` by default; pass `?include_signed_tx=true` to include it.

### Sharing
Secrets can be shared between users and agents via links (with optional passphrase and IP restrictions), direct user/agent shares, or "share back to creator" for agents. Inbound shares require explicit accept/decline.

## API (OpenAPI 3.1)

Base URL: `https://api.1claw.xyz`

Key endpoints:
- `POST /v1/auth/token` — Login
- `DELETE /v1/auth/token` — Revoke current Bearer token (returns 200; reused token then returns 401)
- `POST /v1/auth/agent-token` — Agent token exchange
- `GET/POST /v1/vaults` — List/create vaults
- `GET/DELETE /v1/vaults/{id}` — Get/delete vault
- `POST/DELETE /v1/vaults/{id}/cmek` — Enable/disable CMEK
- `POST /v1/vaults/{id}/cmek-rotate` — Start CMEK rotation
- `GET/PUT/DELETE /v1/vaults/{id}/secrets/{path}` — CRUD secrets
- `GET/POST /v1/agents` — List/create agents
- `POST /v1/agents/enroll` — Agent self-enrollment (public, emails credentials to human)
- `GET/PATCH/DELETE /v1/agents/{id}` — Get/update/delete agent
- `POST /v1/agents/{id}/transactions` — Submit transaction
- `POST /v1/agents/{id}/transactions/simulate` — Simulate transaction
- `GET/POST /v1/vaults/{id}/policies` — List/create policies
- `GET /v1/audit/events` — Query audit log
- `GET /v1/billing/subscription` — Billing status
- `GET /v1/chains` — Supported blockchains

Full spec: https://www.npmjs.com/package/@1claw/openapi-spec

**API limits and security:** Request body size is limited to 5MB (413 if exceeded). Public auth routes (e.g. login, signup) are rate-limited (5 req burst, 1/sec); 429 when exceeded. Revoked tokens (via `DELETE /v1/auth/token`) are rejected with 401.

## Billing

- Free: 1,000 req/mo, 3 vaults, 50 secrets, 2 agents
- Pro ($29/mo): 25,000 req/mo, 25 vaults, 500 secrets, 10 agents
- Business ($149/mo): 100,000 req/mo, 100 vaults, 5,000 secrets, 50 agents, CMEK
- Enterprise: Custom, unlimited, KMS delegation, BAA

Overage: prepaid credits or x402 on-chain micropayments on Base.

## MCP Tools (for AI agents)

The MCP server at mcp.1claw.xyz provides these tools:
- list_secrets, get_secret, put_secret, delete_secret, describe_secret
- rotate_and_store, get_env_bundle
- create_vault, list_vaults, grant_access, share_secret
- simulate_transaction, submit_transaction

Configure in Claude Desktop, Cursor, or any MCP-compatible client with agent credentials.
